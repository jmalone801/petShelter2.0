{"ast":null,"code":"import _objectSpread from\"/Users/jamesmalone/Documents/Coding Stuff/Personal Projects/petShelter/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/Users/jamesmalone/Documents/Coding Stuff/Personal Projects/petShelter/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/jamesmalone/Documents/Coding Stuff/Personal Projects/petShelter/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/jamesmalone/Documents/Coding Stuff/Personal Projects/petShelter/client/node_modules/@babel/runtime/regenerator/index.js\";import axios from'axios';import React,{useEffect,useState}from'react';import{useParams,useHistory}from\"react-router-dom\";import background from\"../assets/petBackground.png\";import Button from'@mui/material/Button';import TextField from'@mui/material/TextField';import{Paper}from'@mui/material';import CircularProgress from'@mui/material/CircularProgress';import Backdrop from'@mui/material/Backdrop';import FormNav from'../Nav/FormNav';import Footer from'../Footer/footer';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Update=function Update(props){var _useParams=useParams(),_id=_useParams._id;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),name=_useState2[0],setName=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),type=_useState4[0],setType=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),description=_useState6[0],setDescription=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),skillOne=_useState8[0],setSkillOne=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),skillTwo=_useState10[0],setSkillTwo=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),skillThree=_useState12[0],setSkillThree=_useState12[1];var _useState13=useState(null),_useState14=_slicedToArray(_useState13,2),file=_useState14[0],setFile=_useState14[1];var _useState15=useState(null),_useState16=_slicedToArray(_useState15,2),image=_useState16[0],setImage=_useState16[1];var _useState17=useState(null),_useState18=_slicedToArray(_useState17,2),cloudinary_id=_useState18[0],setCloudinary_id=_useState18[1];var _useState19=useState(true),_useState20=_slicedToArray(_useState19,2),spinner=_useState20[0],setSpinner=_useState20[1];var _useState21=useState({}),_useState22=_slicedToArray(_useState21,2),errors=_useState22[0],setErrors=_useState22[1];var history=useHistory();// Retrieves one single pet by id\nuseEffect(function(){axios.get('http://localhost:8000/api/pet/'+_id).then(function(res){setName(res.data.name);setType(res.data.type);setDescription(res.data.description);setSkillOne(res.data.skillOne);setSkillTwo(res.data.skillTwo);setSkillThree(res.data.skillThree);setImage(res.data.image);}).catch(function(err){return console.error(err);});},[_id]);// Handles image preview\nvar handleOnChange=function handleOnChange(event){var reader=new FileReader();reader.onload=function(onLoadEvent){setFile(onLoadEvent.target.result);setImage(null);setCloudinary_id(null);};reader.readAsDataURL(event.target.files[0]);};// Updates one single pet by id\nvar updatePet=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var formData,result,imageData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();// Checks if user uploaded a file\n// If user did upload a file, it POSTs both Axios calls\nif(!(file!=null)){_context.next=14;break;}// Starts spinner\nsetSpinner(false);// Sets up image to be sent to Cloudinary\nformData=new FormData();formData.append('file',file);formData.append('upload_preset','petShelter');// Uploading the image to Cloudinary\n_context.next=8;return axios.post('https://api.cloudinary.com/v1_1/jamescloudinaryforphotos/upload',formData);case 8:result=_context.sent;// Packages data to send into database\nimageData={image:result.data.secure_url,cloudinary_id:result.data.public_id};axios.put('http://localhost:8000/api/pet/update/'+_id,_objectSpread({name:name,type:type,description:description,skillOne:skillOne,skillTwo:skillTwo,skillThree:skillThree},imageData))// Displays validiations for edit\n.then(function(res){console.log(res);if(res.data.errors){setErrors(res.data.errors);}else{history.push(\"/\");}}).catch(function(err){return console.log(err);});// Stops spinner\nsetSpinner(true);// If user did NOT upload file, it only POSTs the following Axios call\n_context.next=17;break;case 14:axios.put('http://localhost:8000/api/pet/update/'+_id,{name:name,type:type,description:description,skillOne:skillOne,skillTwo:skillTwo,skillThree:skillThree})// Displays validiations for edit\n.then(function(res){console.log(res);if(res.data.errors){setErrors(res.data.errors);}else{history.push(\"/\");}}).catch(function(err){return console.log(err);});console.log(image);console.log(cloudinary_id);case 17:case\"end\":return _context.stop();}}},_callee);}));return function updatePet(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(FormNav,{}),/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'center',backgroundImage:\"url(\".concat(background,\")\"),backgroundRepeat:'repeat',marginTop:'60px'},children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h3\",{style:{marginTop:'40px',marginBottom:'20px',fontWeight:'bold',color:'#474747'},children:[\"Make changes to \",name]}),/*#__PURE__*/_jsx(Paper,{elevation:2,style:{width:'600px',padding:20,marginBottom:'100px',backgroundColor:\"rgb(247 247 247 / 87%)\"},children:/*#__PURE__*/_jsx(\"form\",{onSubmit:updatePet,children:/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',flexDirection:'column',justifyContent:'space-between',columnGap:'80px'},children:[/*#__PURE__*/_jsx(\"h5\",{style:{textAlign:'left'},children:\"Pet Information\"}),/*#__PURE__*/_jsx(TextField,{label:\"Pet Name\",type:\"text\",variant:\"filled\",fullWidth:true,onChange:function onChange(event){return setName(event.target.value);},value:name}),/*#__PURE__*/_jsx(\"p\",{className:\"danger\",children:errors.name?errors.name.message:\"\"}),/*#__PURE__*/_jsx(TextField,{label:\"Pet Type\",type:\"text\",variant:\"filled\",fullWidth:true,onChange:function onChange(event){return setType(event.target.value);},value:type}),/*#__PURE__*/_jsx(\"p\",{className:\"danger\",children:errors.type?errors.type.message:\"\"}),/*#__PURE__*/_jsx(TextField,{label:\"Pet Description\",type:\"text\",variant:\"filled\",multiline:true,rows:4,fullWidth:true,onChange:function onChange(event){return setDescription(event.target.value);},value:description}),/*#__PURE__*/_jsx(\"p\",{className:\"danger\",children:errors.description?errors.description.message:\"\"}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"h5\",{style:{textAlign:'left'},children:[\"Pet Skills \",/*#__PURE__*/_jsx(\"span\",{style:{color:'grey'},children:\"(Optional)\"})]}),/*#__PURE__*/_jsx(TextField,{label:\"Skill One\",type:\"text\",variant:\"filled\",fullWidth:true,onChange:function onChange(event){return setSkillOne(event.target.value);},value:skillOne}),/*#__PURE__*/_jsx(\"p\",{}),/*#__PURE__*/_jsx(TextField,{label:\"Skill Two\",type:\"text\",variant:\"filled\",fullWidth:true,onChange:function onChange(event){return setSkillTwo(event.target.value);},value:skillTwo}),/*#__PURE__*/_jsx(\"p\",{}),/*#__PURE__*/_jsx(TextField,{label:\"Skill Three\",type:\"text\",variant:\"filled\",fullWidth:true,onChange:function onChange(event){return setSkillThree(event.target.value);},value:skillThree}),/*#__PURE__*/_jsx(\"p\",{}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"image\",name:\"image\",onChange:handleOnChange}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'center'},children:/*#__PURE__*/_jsx(\"img\",{src:image||file||'https://res.cloudinary.com/jamescloudinaryforphotos/image/upload/v1660004528/petShelterUploads/stmfyh6uzxkt2bmqf01l.png',alt:\"Preview\",style:{width:'200px'}})}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between'},children:[/*#__PURE__*/_jsx(Button,{href:\"/\",variant:\"text\",style:{color:'grey'},children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"contained\",style:{backgroundColor:'rgb(248, 181, 161)',width:'140px'},children:\"Submit\"}),spinner?spinner:/*#__PURE__*/_jsx(Backdrop,{style:{color:'#fff'},open:true,children:/*#__PURE__*/_jsx(CircularProgress,{color:\"inherit\"})})]})]})})})]})}),/*#__PURE__*/_jsx(Footer,{})]});};export default Update;","map":{"version":3,"sources":["/Users/jamesmalone/Documents/Coding Stuff/Personal Projects/petShelter/client/src/components/UpdateOne/Update.jsx"],"names":["axios","React","useEffect","useState","useParams","useHistory","background","Button","TextField","Paper","CircularProgress","Backdrop","FormNav","Footer","Update","props","_id","name","setName","type","setType","description","setDescription","skillOne","setSkillOne","skillTwo","setSkillTwo","skillThree","setSkillThree","file","setFile","image","setImage","cloudinary_id","setCloudinary_id","spinner","setSpinner","errors","setErrors","history","get","then","res","data","catch","err","console","error","handleOnChange","event","reader","FileReader","onload","onLoadEvent","target","result","readAsDataURL","files","updatePet","preventDefault","formData","FormData","append","post","imageData","secure_url","public_id","put","log","push","display","justifyContent","backgroundImage","backgroundRepeat","marginTop","marginBottom","fontWeight","color","width","padding","backgroundColor","flexDirection","columnGap","textAlign","value","message"],"mappings":"8oBAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CACA,OAASC,SAAT,CAAoBC,UAApB,KAAsC,kBAAtC,CACA,MAAOC,CAAAA,UAAP,KAAuB,6BAAvB,CACA,MAAOC,CAAAA,MAAP,KAAmB,sBAAnB,CACA,MAAOC,CAAAA,SAAP,KAAsB,yBAAtB,CACA,OAASC,KAAT,KAAsB,eAAtB,CACA,MAAOC,CAAAA,gBAAP,KAA6B,gCAA7B,CACA,MAAOC,CAAAA,QAAP,KAAqB,wBAArB,CACA,MAAOC,CAAAA,OAAP,KAAoB,gBAApB,CACA,MAAOC,CAAAA,MAAP,KAAmB,kBAAnB,C,wFAGA,GAAMC,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,CAACC,KAAD,CAAW,CACtB,eAAgBX,SAAS,EAAzB,CAAQY,GAAR,YAAQA,GAAR,CACA,cAAwBb,QAAQ,CAAC,EAAD,CAAhC,wCAAOc,IAAP,eAAaC,OAAb,eACA,eAAwBf,QAAQ,CAAC,EAAD,CAAhC,yCAAOgB,IAAP,eAAaC,OAAb,eACA,eAAsCjB,QAAQ,CAAC,EAAD,CAA9C,yCAAOkB,WAAP,eAAoBC,cAApB,eACA,eAAgCnB,QAAQ,CAAC,EAAD,CAAxC,yCAAOoB,QAAP,eAAiBC,WAAjB,eACA,eAAgCrB,QAAQ,CAAC,EAAD,CAAxC,0CAAOsB,QAAP,gBAAiBC,WAAjB,gBACA,gBAAoCvB,QAAQ,CAAC,EAAD,CAA5C,2CAAOwB,UAAP,gBAAmBC,aAAnB,gBACA,gBAAwBzB,QAAQ,CAAC,IAAD,CAAhC,2CAAO0B,IAAP,gBAAaC,OAAb,gBACA,gBAA0B3B,QAAQ,CAAC,IAAD,CAAlC,2CAAO4B,KAAP,gBAAcC,QAAd,gBACA,gBAA0C7B,QAAQ,CAAC,IAAD,CAAlD,2CAAO8B,aAAP,gBAAsBC,gBAAtB,gBACA,gBAA8B/B,QAAQ,CAAC,IAAD,CAAtC,2CAAOgC,OAAP,gBAAgBC,UAAhB,gBACA,gBAA4BjC,QAAQ,CAAC,EAAD,CAApC,2CAAOkC,MAAP,gBAAeC,SAAf,gBACA,GAAMC,CAAAA,OAAO,CAAGlC,UAAU,EAA1B,CAEA;AACAH,SAAS,CAAC,UAAM,CACZF,KAAK,CAACwC,GAAN,CAAU,iCAAmCxB,GAA7C,EACKyB,IADL,CACU,SAAAC,GAAG,CAAI,CACTxB,OAAO,CAACwB,GAAG,CAACC,IAAJ,CAAS1B,IAAV,CAAP,CACAG,OAAO,CAACsB,GAAG,CAACC,IAAJ,CAASxB,IAAV,CAAP,CACAG,cAAc,CAACoB,GAAG,CAACC,IAAJ,CAAStB,WAAV,CAAd,CACAG,WAAW,CAACkB,GAAG,CAACC,IAAJ,CAASpB,QAAV,CAAX,CACAG,WAAW,CAACgB,GAAG,CAACC,IAAJ,CAASlB,QAAV,CAAX,CACAG,aAAa,CAACc,GAAG,CAACC,IAAJ,CAAShB,UAAV,CAAb,CACAK,QAAQ,CAACU,GAAG,CAACC,IAAJ,CAASZ,KAAV,CAAR,CACH,CATL,EAUKa,KAVL,CAUW,SAAAC,GAAG,QAAIC,CAAAA,OAAO,CAACC,KAAR,CAAcF,GAAd,CAAJ,EAVd,EAWH,CAZQ,CAYN,CAAC7B,GAAD,CAZM,CAAT,CAcA;AACA,GAAMgC,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,CAACC,KAAD,CAAW,CAC9B,GAAMC,CAAAA,MAAM,CAAG,GAAIC,CAAAA,UAAJ,EAAf,CACAD,MAAM,CAACE,MAAP,CAAgB,SAAUC,WAAV,CAAuB,CACnCvB,OAAO,CAACuB,WAAW,CAACC,MAAZ,CAAmBC,MAApB,CAAP,CACAvB,QAAQ,CAAC,IAAD,CAAR,CACAE,gBAAgB,CAAC,IAAD,CAAhB,CACH,CAJD,CAKAgB,MAAM,CAACM,aAAP,CAAqBP,KAAK,CAACK,MAAN,CAAaG,KAAb,CAAmB,CAAnB,CAArB,EACH,CARD,CAWA;AACA,GAAMC,CAAAA,SAAS,0FAAG,iBAAOT,KAAP,gJACdA,KAAK,CAACU,cAAN,GAEA;AACA;AAJc,KAKV9B,IAAI,EAAI,IALE,2BAMV;AACAO,UAAU,CAAC,KAAD,CAAV,CACA;AACMwB,QATI,CASO,GAAIC,CAAAA,QAAJ,EATP,CAUVD,QAAQ,CAACE,MAAT,CAAgB,MAAhB,CAAwBjC,IAAxB,EACA+B,QAAQ,CAACE,MAAT,CAAgB,eAAhB,CAAiC,YAAjC,EACA;AAZU,sBAaW9D,CAAAA,KAAK,CAAC+D,IAAN,CAAW,iEAAX,CAA8EH,QAA9E,CAbX,QAaJL,MAbI,eAeV;AACMS,SAhBI,CAgBQ,CACdjC,KAAK,CAAEwB,MAAM,CAACZ,IAAP,CAAYsB,UADL,CAEdhC,aAAa,CAAEsB,MAAM,CAACZ,IAAP,CAAYuB,SAFb,CAhBR,CAsBVlE,KAAK,CAACmE,GAAN,CAAU,wCAA0CnD,GAApD,gBACIC,IAAI,CAAJA,IADJ,CAEIE,IAAI,CAAJA,IAFJ,CAGIE,WAAW,CAAXA,WAHJ,CAIIE,QAAQ,CAARA,QAJJ,CAKIE,QAAQ,CAARA,QALJ,CAMIE,UAAU,CAAVA,UANJ,EAOOqC,SAPP,EASI;AATJ,CAUKvB,IAVL,CAUU,SAAAC,GAAG,CAAI,CACTI,OAAO,CAACsB,GAAR,CAAY1B,GAAZ,EACA,GAAIA,GAAG,CAACC,IAAJ,CAASN,MAAb,CAAqB,CACjBC,SAAS,CAACI,GAAG,CAACC,IAAJ,CAASN,MAAV,CAAT,CACH,CAFD,IAGK,CACDE,OAAO,CAAC8B,IAAR,CAAa,GAAb,EACH,CACJ,CAlBL,EAmBKzB,KAnBL,CAmBW,SAAAC,GAAG,QAAIC,CAAAA,OAAO,CAACsB,GAAR,CAAYvB,GAAZ,CAAJ,EAnBd,EAoBA;AACAT,UAAU,CAAC,IAAD,CAAV,CAEJ;AA7Cc,+BA+CVpC,KAAK,CAACmE,GAAN,CAAU,wCAA0CnD,GAApD,CAAyD,CACrDC,IAAI,CAAJA,IADqD,CAErDE,IAAI,CAAJA,IAFqD,CAGrDE,WAAW,CAAXA,WAHqD,CAIrDE,QAAQ,CAARA,QAJqD,CAKrDE,QAAQ,CAARA,QALqD,CAMrDE,UAAU,CAAVA,UANqD,CAAzD,CAQI;AARJ,CASKc,IATL,CASU,SAAAC,GAAG,CAAI,CACTI,OAAO,CAACsB,GAAR,CAAY1B,GAAZ,EACA,GAAIA,GAAG,CAACC,IAAJ,CAASN,MAAb,CAAqB,CACjBC,SAAS,CAACI,GAAG,CAACC,IAAJ,CAASN,MAAV,CAAT,CACH,CAFD,IAGK,CACDE,OAAO,CAAC8B,IAAR,CAAa,GAAb,EACH,CACJ,CAjBL,EAkBKzB,KAlBL,CAkBW,SAAAC,GAAG,QAAIC,CAAAA,OAAO,CAACsB,GAAR,CAAYvB,GAAZ,CAAJ,EAlBd,EAmBAC,OAAO,CAACsB,GAAR,CAAYrC,KAAZ,EACAe,OAAO,CAACsB,GAAR,CAAYnC,aAAZ,EAnEU,uDAAH,kBAATyB,CAAAA,SAAS,4CAAf,CAuEA,mBACI,oCACI,KAAC,OAAD,IADJ,cAEI,YAAK,KAAK,CAAE,CACRY,OAAO,CAAE,MADD,CAERC,cAAc,CAAE,QAFR,CAGRC,eAAe,eAASlE,UAAT,KAHP,CAIRmE,gBAAgB,CAAE,QAJV,CAKRC,SAAS,CAAE,MALH,CAAZ,uBAQI,oCACI,YAAI,KAAK,CAAE,CAAEA,SAAS,CAAE,MAAb,CAAqBC,YAAY,CAAE,MAAnC,CAA2CC,UAAU,CAAE,MAAvD,CAA+DC,KAAK,CAAE,SAAtE,CAAX,8BAA+G5D,IAA/G,GADJ,cAEI,KAAC,KAAD,EACI,SAAS,CAAE,CADf,CAEI,KAAK,CAAE,CACH6D,KAAK,CAAE,OADJ,CAEHC,OAAO,CAAE,EAFN,CAGHJ,YAAY,CAAE,OAHX,CAIHK,eAAe,CAAE,wBAJd,CAFX,uBAQI,aAAM,QAAQ,CAAEtB,SAAhB,uBACI,aAAK,KAAK,CAAE,CACRY,OAAO,CAAE,MADD,CAERW,aAAa,CAAE,QAFP,CAGRV,cAAc,CAAE,eAHR,CAIRW,SAAS,CAAE,MAJH,CAAZ,wBAMI,WAAI,KAAK,CAAE,CAAEC,SAAS,CAAE,MAAb,CAAX,6BANJ,cAOI,KAAC,SAAD,EACI,KAAK,CAAC,UADV,CAEI,IAAI,CAAC,MAFT,CAGI,OAAO,CAAC,QAHZ,CAII,SAAS,KAJb,CAKI,QAAQ,CAAE,kBAAClC,KAAD,QAAW/B,CAAAA,OAAO,CAAC+B,KAAK,CAACK,MAAN,CAAa8B,KAAd,CAAlB,EALd,CAKsD,KAAK,CAAEnE,IAL7D,EAPJ,cAaI,UAAG,SAAS,CAAC,QAAb,UAAuBoB,MAAM,CAACpB,IAAP,CAAcoB,MAAM,CAACpB,IAAP,CAAYoE,OAA1B,CAAoC,EAA3D,EAbJ,cAcI,KAAC,SAAD,EACI,KAAK,CAAC,UADV,CAEI,IAAI,CAAC,MAFT,CAEgB,OAAO,CAAC,QAFxB,CAGI,SAAS,KAHb,CAII,QAAQ,CAAE,kBAACpC,KAAD,QAAW7B,CAAAA,OAAO,CAAC6B,KAAK,CAACK,MAAN,CAAa8B,KAAd,CAAlB,EAJd,CAIsD,KAAK,CAAEjE,IAJ7D,EAdJ,cAmBI,UAAG,SAAS,CAAC,QAAb,UAAuBkB,MAAM,CAAClB,IAAP,CAAckB,MAAM,CAAClB,IAAP,CAAYkE,OAA1B,CAAoC,EAA3D,EAnBJ,cAoBI,KAAC,SAAD,EACI,KAAK,CAAC,iBADV,CAEI,IAAI,CAAC,MAFT,CAGI,OAAO,CAAC,QAHZ,CAII,SAAS,KAJb,CAKI,IAAI,CAAE,CALV,CAMI,SAAS,KANb,CAOI,QAAQ,CAAE,kBAACpC,KAAD,QAAW3B,CAAAA,cAAc,CAAC2B,KAAK,CAACK,MAAN,CAAa8B,KAAd,CAAzB,EAPd,CAO6D,KAAK,CAAE/D,WAPpE,EApBJ,cA4BI,UAAG,SAAS,CAAC,QAAb,UAAuBgB,MAAM,CAAChB,WAAP,CAAqBgB,MAAM,CAAChB,WAAP,CAAmBgE,OAAxC,CAAkD,EAAzE,EA5BJ,cA6BI,aA7BJ,cA8BI,YAAI,KAAK,CAAE,CAAEF,SAAS,CAAE,MAAb,CAAX,sCAA6C,aAAM,KAAK,CAAE,CAAEN,KAAK,CAAE,MAAT,CAAb,wBAA7C,GA9BJ,cA+BI,KAAC,SAAD,EACI,KAAK,CAAC,WADV,CAEI,IAAI,CAAC,MAFT,CAGI,OAAO,CAAC,QAHZ,CAII,SAAS,KAJb,CAKI,QAAQ,CAAE,kBAAC5B,KAAD,QAAWzB,CAAAA,WAAW,CAACyB,KAAK,CAACK,MAAN,CAAa8B,KAAd,CAAtB,EALd,CAK0D,KAAK,CAAE7D,QALjE,EA/BJ,cAqCI,YArCJ,cAsCI,KAAC,SAAD,EACI,KAAK,CAAC,WADV,CAEI,IAAI,CAAC,MAFT,CAGI,OAAO,CAAC,QAHZ,CAII,SAAS,KAJb,CAKI,QAAQ,CAAE,kBAAC0B,KAAD,QAAWvB,CAAAA,WAAW,CAACuB,KAAK,CAACK,MAAN,CAAa8B,KAAd,CAAtB,EALd,CAK0D,KAAK,CAAE3D,QALjE,EAtCJ,cA4CI,YA5CJ,cA6CI,KAAC,SAAD,EACI,KAAK,CAAC,aADV,CAEI,IAAI,CAAC,MAFT,CAGI,OAAO,CAAC,QAHZ,CAII,SAAS,KAJb,CAKI,QAAQ,CAAE,kBAACwB,KAAD,QAAWrB,CAAAA,aAAa,CAACqB,KAAK,CAACK,MAAN,CAAa8B,KAAd,CAAxB,EALd,CAK4D,KAAK,CAAEzD,UALnE,EA7CJ,cAmDI,YAnDJ,cAqDI,cACI,IAAI,CAAC,MADT,CAEI,EAAE,CAAC,OAFP,CAGI,IAAI,CAAC,OAHT,CAII,QAAQ,CAAEqB,cAJd,EArDJ,cA2DI,aA3DJ,cA6DI,YAAK,KAAK,CAAE,CAAEsB,OAAO,CAAE,MAAX,CAAmBC,cAAc,CAAE,QAAnC,CAAZ,uBACI,YAAK,GAAG,CAAExC,KAAK,EAAIF,IAAT,EAAiB,yHAA3B,CACI,GAAG,CAAC,SADR,CAEI,KAAK,CAAE,CAAEiD,KAAK,CAAE,OAAT,CAFX,EADJ,EA7DJ,cAoEI,aAAK,KAAK,CAAE,CAAER,OAAO,CAAE,MAAX,CAAmBC,cAAc,CAAE,eAAnC,CAAZ,wBACI,KAAC,MAAD,EACI,IAAI,CAAC,GADT,CAEI,OAAO,CAAC,MAFZ,CAGI,KAAK,CAAE,CAAEM,KAAK,CAAE,MAAT,CAHX,oBADJ,cAMI,KAAC,MAAD,EACI,IAAI,CAAC,QADT,CAEI,OAAO,CAAC,WAFZ,CAGI,KAAK,CAAE,CAAEG,eAAe,CAAE,oBAAnB,CAAyCF,KAAK,CAAE,OAAhD,CAHX,oBANJ,CAWK3C,OAAO,CAAGA,OAAH,cAAa,KAAC,QAAD,EAAU,KAAK,CAAE,CAAE0C,KAAK,CAAE,MAAT,CAAjB,CAAqC,IAAI,KAAzC,uBACjB,KAAC,gBAAD,EAAkB,KAAK,CAAC,SAAxB,EADiB,EAXzB,GApEJ,GADJ,EARJ,EAFJ,GARJ,EAFJ,cA6GI,KAAC,MAAD,IA7GJ,GADJ,CAmHH,CArOD,CAsOA,cAAe/D,CAAAA,MAAf","sourcesContent":["import axios from 'axios';\nimport React, { useEffect, useState } from 'react'\nimport { useParams, useHistory } from \"react-router-dom\";\nimport background from \"../assets/petBackground.png\";\nimport Button from '@mui/material/Button';\nimport TextField from '@mui/material/TextField';\nimport { Paper } from '@mui/material';\nimport CircularProgress from '@mui/material/CircularProgress';\nimport Backdrop from '@mui/material/Backdrop';\nimport FormNav from '../Nav/FormNav';\nimport Footer from '../Footer/footer';\n\n\nconst Update = (props) => {\n    const { _id } = useParams();\n    const [name, setName] = useState(\"\");\n    const [type, setType] = useState(\"\");\n    const [description, setDescription] = useState(\"\");\n    const [skillOne, setSkillOne] = useState(\"\");\n    const [skillTwo, setSkillTwo] = useState(\"\");\n    const [skillThree, setSkillThree] = useState(\"\");\n    const [file, setFile] = useState(null);\n    const [image, setImage] = useState(null);\n    const [cloudinary_id, setCloudinary_id] = useState(null);\n    const [spinner, setSpinner] = useState(true);\n    const [errors, setErrors] = useState({});\n    const history = useHistory();\n\n    // Retrieves one single pet by id\n    useEffect(() => {\n        axios.get('http://localhost:8000/api/pet/' + _id)\n            .then(res => {\n                setName(res.data.name);\n                setType(res.data.type);\n                setDescription(res.data.description);\n                setSkillOne(res.data.skillOne);\n                setSkillTwo(res.data.skillTwo);\n                setSkillThree(res.data.skillThree);\n                setImage(res.data.image)\n            })\n            .catch(err => console.error(err));\n    }, [_id]);\n\n    // Handles image preview\n    const handleOnChange = (event) => {\n        const reader = new FileReader();\n        reader.onload = function (onLoadEvent) {\n            setFile(onLoadEvent.target.result);\n            setImage(null)\n            setCloudinary_id(null)\n        }\n        reader.readAsDataURL(event.target.files[0]);\n    }\n\n\n    // Updates one single pet by id\n    const updatePet = async (event) => {\n        event.preventDefault();\n\n        // Checks if user uploaded a file\n        // If user did upload a file, it POSTs both Axios calls\n        if (file != null) {\n            // Starts spinner\n            setSpinner(false)\n            // Sets up image to be sent to Cloudinary\n            const formData = new FormData();\n            formData.append('file', file)\n            formData.append('upload_preset', 'petShelter')\n            // Uploading the image to Cloudinary\n            const result = await axios.post('https://api.cloudinary.com/v1_1/jamescloudinaryforphotos/upload', formData)\n\n            // Packages data to send into database\n            const imageData = {\n                image: result.data.secure_url,\n                cloudinary_id: result.data.public_id\n            }\n\n\n            axios.put('http://localhost:8000/api/pet/update/' + _id, {\n                name,\n                type,\n                description,\n                skillOne,\n                skillTwo,\n                skillThree,\n                ...imageData\n            })\n                // Displays validiations for edit\n                .then(res => {\n                    console.log(res)\n                    if (res.data.errors) {\n                        setErrors(res.data.errors)\n                    }\n                    else {\n                        history.push(\"/\")\n                    }\n                })\n                .catch(err => console.log(err))\n            // Stops spinner\n            setSpinner(true)\n\n        // If user did NOT upload file, it only POSTs the following Axios call\n        } else {\n            axios.put('http://localhost:8000/api/pet/update/' + _id, {\n                name,\n                type,\n                description,\n                skillOne,\n                skillTwo,\n                skillThree\n            })\n                // Displays validiations for edit\n                .then(res => {\n                    console.log(res)\n                    if (res.data.errors) {\n                        setErrors(res.data.errors)\n                    }\n                    else {\n                        history.push(\"/\")\n                    }\n                })\n                .catch(err => console.log(err))\n            console.log(image)\n            console.log(cloudinary_id)\n        }\n    }\n\n    return (\n        <div>\n            <FormNav />\n            <div style={{\n                display: 'flex',\n                justifyContent: 'center',\n                backgroundImage: `url(${background})`,\n                backgroundRepeat: 'repeat',\n                marginTop: '60px',\n            }}>\n\n                <div>\n                    <h3 style={{ marginTop: '40px', marginBottom: '20px', fontWeight: 'bold', color: '#474747' }}>Make changes to {name}</h3>\n                    <Paper\n                        elevation={2}\n                        style={{\n                            width: '600px',\n                            padding: 20,\n                            marginBottom: '100px',\n                            backgroundColor: \"rgb(247 247 247 / 87%)\"\n                        }}>\n                        <form onSubmit={updatePet}>\n                            <div style={{\n                                display: 'flex',\n                                flexDirection: 'column',\n                                justifyContent: 'space-between',\n                                columnGap: '80px'\n                            }} >\n                                <h5 style={{ textAlign: 'left' }}>Pet Information</h5>\n                                <TextField\n                                    label=\"Pet Name\"\n                                    type=\"text\"\n                                    variant=\"filled\"\n                                    fullWidth\n                                    onChange={(event) => setName(event.target.value)} value={name} />\n                                <p className='danger'>{errors.name ? errors.name.message : \"\"}</p>\n                                <TextField\n                                    label=\"Pet Type\"\n                                    type=\"text\" variant=\"filled\"\n                                    fullWidth\n                                    onChange={(event) => setType(event.target.value)} value={type} />\n                                <p className='danger'>{errors.type ? errors.type.message : \"\"}</p>\n                                <TextField\n                                    label=\"Pet Description\"\n                                    type=\"text\"\n                                    variant=\"filled\"\n                                    multiline\n                                    rows={4}\n                                    fullWidth\n                                    onChange={(event) => setDescription(event.target.value)} value={description} />\n                                <p className='danger'>{errors.description ? errors.description.message : \"\"}</p>\n                                <hr />\n                                <h5 style={{ textAlign: 'left' }}>Pet Skills <span style={{ color: 'grey' }} >(Optional)</span></h5>\n                                <TextField\n                                    label=\"Skill One\"\n                                    type=\"text\"\n                                    variant=\"filled\"\n                                    fullWidth\n                                    onChange={(event) => setSkillOne(event.target.value)} value={skillOne} />\n                                <p></p>\n                                <TextField\n                                    label=\"Skill Two\"\n                                    type=\"text\"\n                                    variant=\"filled\"\n                                    fullWidth\n                                    onChange={(event) => setSkillTwo(event.target.value)} value={skillTwo} />\n                                <p></p>\n                                <TextField\n                                    label=\"Skill Three\"\n                                    type=\"text\"\n                                    variant=\"filled\"\n                                    fullWidth\n                                    onChange={(event) => setSkillThree(event.target.value)} value={skillThree} />\n                                <p></p>\n\n                                <input\n                                    type=\"file\"\n                                    id=\"image\"\n                                    name=\"image\"\n                                    onChange={handleOnChange}\n                                />\n                                <br></br>\n\n                                <div style={{ display: 'flex', justifyContent: 'center' }}>\n                                    <img src={image || file || 'https://res.cloudinary.com/jamescloudinaryforphotos/image/upload/v1660004528/petShelterUploads/stmfyh6uzxkt2bmqf01l.png'}\n                                        alt=\"Preview\"\n                                        style={{ width: '200px' }}\n                                    />\n                                </div>\n\n                                <div style={{ display: 'flex', justifyContent: 'space-between' }}>\n                                    <Button\n                                        href=\"/\"\n                                        variant=\"text\"\n                                        style={{ color: 'grey' }}>Cancel\n                                    </Button>\n                                    <Button\n                                        type=\"submit\"\n                                        variant=\"contained\"\n                                        style={{ backgroundColor: 'rgb(248, 181, 161)', width: '140px' }}>Submit\n                                    </Button>\n                                    {spinner ? spinner : <Backdrop style={{ color: '#fff', }} open>\n                                        <CircularProgress color=\"inherit\" />\n                                    </Backdrop>}\n                                </div>\n                            </div>\n                        </form>\n                    </Paper>\n                </div>\n            </div>\n            <Footer />\n        </div>\n    )\n\n\n}\nexport default Update;"]},"metadata":{},"sourceType":"module"}